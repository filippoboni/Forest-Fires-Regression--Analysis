---
title: "Tesina MML"
author: "Filippo Boni"
date: "2/4/2021"
output: html_document
---
```{r}
#imports
library(gridExtra)
library(ggplot2)
library(tidyverse)
library(GGally)
library(leaps)
#set options
options(max.print = 100)
```

## Introduzione
Forest fires analysis through regression to predict possible fires and burned area;
in this project our aim is, in the first part, to predict the burned area of forest fires in the northeast region of Portugal. Our prediction will be based on spacial, temporal and weather variables where the fire is spotted.  

## Dataset Overview
The data we are using to predict the creation and the intensity of forest fires has been created by Cortez and Moraiz and acquired from the UCI Machine Learning Repo. It consists of 517 observations of forest fires and wildfires from Montesinho Park, located in Portugal, collected from January 2000 to December 2003. The dataset is composed by 13 variables including the output variable *area* (i.e. the area of the forest fire in hectares).

## Variables 
```{r}
#read data
fires <- read.csv(file = "forestfires.csv",header = TRUE,stringsAsFactors = TRUE)
fires$X <- as.factor(fires$X)
fires$Y <- as.factor(fires$Y)

#create column fire for future logistic/classification
fires$fire <- rep("No",length(fires$X))
fires$fire[fires$area>0] <-"Yes"

#set the new column as categorical
fires$fire <- as.factor(fires$fire)
attach(fires)
str(fires)
```

## EDA
By a first analysis of the outcome variable *area* we can see that the dataset has approximately the same number of small fires (identified with 0) and big ones, again we see how this dataset may be better for a binary classification. But let's move on on the linear regression.
```{r}
ggplot(fires,aes(x=fire))+
  geom_bar(fill = "steelblue")+ 
  xlab("Big Fire") + theme_minimal(base_size = 12)
```

let's move on on the analysis of the target variable: in the later histograms we can see that the burned area is positively skewed with the majority of fires presenting a small size (a area lower that 100m2 was burned). As suggested from the paper of Martinez, to reduce the skeweness and and improve simmetry, the log transformation was applied to the area attribute. As we can see from the left histogram, the area is now less right-skewed and has a more gaussian shape, allowing us to stick with the normality assumption necessary for linear regression. 
```{r}
#skewness of the target variable
area_plot <-ggplot(data = fires)+
  geom_histogram(aes(area),binwidth = 40)+
  theme_minimal(base_size = 11)+
  xlab("Burned area (in hectares)")

#applying log transformation to get a more gaussian like shape
log_area_plot<-ggplot(data = fires)+
  geom_histogram(aes(log(area+1)),binwidth = 0.3,fill = "steelblue")+
  theme_minimal(base_size = 11)+
  xlab("Ln(area +1)")   
  
grid.arrange(area_plot,log_area_plot,ncol=2)
```

## Correlations
Let's now study the correlations among the variables, excluding the categorical ones
```{r}
drop_vars <- names(fires) %in% c("X","Y","month","day","fire")
ggcorr(fires[!drop_vars], label=TRUE, label_size=4, label_color='black')
```

As we can see from the correlation plot, correlations pairs are pretty much zero (except for DC-DMC) and later we may think to drop one of the two in order to maintain the independence assumption for multiple linear regression

we can see from the plot a pattern btw the two
```{r}
plot(fires[,6:7])
```

## Regression Models
Firstly we will try to predict the burned area with the general linear model, then we will switch to logistic regression and predict whether a fire will be big or not.
```{r}

```

